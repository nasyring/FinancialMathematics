<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 5 A flexible derivative pricing model | FinancialMathematics</title>
<meta name="author" content="Nick Syring">
<meta name="description" content="The model we consider in this section is the Bakshi-Cao- (BCC) model from “Empirical Performance of Alternative Option Pricing Models” in The Journal of Finance, Vol. 52, No. 5 (Dec., 1997),...">
<meta name="generator" content="bookdown 0.24 with bs4_book()">
<meta property="og:title" content="Chapter 5 A flexible derivative pricing model | FinancialMathematics">
<meta property="og:type" content="book">
<meta property="og:description" content="The model we consider in this section is the Bakshi-Cao- (BCC) model from “Empirical Performance of Alternative Option Pricing Models” in The Journal of Finance, Vol. 52, No. 5 (Dec., 1997),...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 5 A flexible derivative pricing model | FinancialMathematics">
<meta name="twitter:description" content="The model we consider in this section is the Bakshi-Cao- (BCC) model from “Empirical Performance of Alternative Option Pricing Models” in The Journal of Finance, Vol. 52, No. 5 (Dec., 1997),...">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/header-attrs-2.11/header-attrs.js"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.3.1/transition.js"></script><script src="libs/bs3compat-0.3.1/tabs.js"></script><script src="libs/bs3compat-0.3.1/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS -->
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="">FinancialMathematics</a>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html"><span class="header-section-number">1</span> Introduction</a></li>
<li><a class="" href="intro.html"><span class="header-section-number">2</span> Introduction</a></li>
<li><a class="" href="the-risk-neutral-framework.html"><span class="header-section-number">3</span> The risk-neutral framework</a></li>
<li><a class="" href="the-geometric-brownian-motion-model-of-asset-value-and-monte-carlo-simulation.html"><span class="header-section-number">4</span> The geometric Brownian motion model of asset value and Monte Carlo simulation</a></li>
<li><a class="active" href="a-flexible-derivative-pricing-model.html"><span class="header-section-number">5</span> A flexible derivative pricing model</a></li>
</ul>

        <div class="book-extra">
          
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="a-flexible-derivative-pricing-model" class="section level1" number="5">
<h1>
<span class="header-section-number">5</span> A flexible derivative pricing model<a class="anchor" aria-label="anchor" href="#a-flexible-derivative-pricing-model"><i class="fas fa-link"></i></a>
</h1>
<p>The model we consider in this section is the Bakshi-Cao- (BCC) model from “Empirical Performance of Alternative Option Pricing Models” in <strong>The Journal of Finance</strong>, Vol. 52, No. 5 (Dec., 1997), pp. 2003-2049.</p>
<p>The BCC model is characterized by a jump-diffusion model of asset price, with a square-root diffusion process for stochastic volatility, and a Cox-Ingersoll-Ross (CIR) for the stochastic short-term interest rate. Formally, the model may be expressed as follows:
<span class="math display">\[\begin{align*}
dS_t &amp;= (r_t - r_J)S_tdt + \sqrt{v_t}S_tdZ_t^1 + J_tS_tdN_t\\
dv_t &amp;= \kappa_v(\theta_v - v_t)dt + \sigma_v\sqrt{v_t}dZ_t^2\\
dr_t &amp;= \kappa_r(\theta_r - r_t)dt + \sigma_r\sqrt{r_t}dZ_t^3.
\end{align*}\]</span></p>
The parameters in the above model have the following meanings:
This model is inspired by several real-world observations, including the following:
<div id="present-value-with-stochastic-short-term-rate" class="section level2" number="5.1">
<h2>
<span class="header-section-number">5.1</span> Present-value with stochastic short-term rate<a class="anchor" aria-label="anchor" href="#present-value-with-stochastic-short-term-rate"><i class="fas fa-link"></i></a>
</h2>
<p>Under continuous compounding the present value at time <span class="math inline">\(t\)</span> of a dollar paid at time <span class="math inline">\(T\)</span> is
<span class="math display">\[B_0(T) = E_t^Q\left(\exp\left\{-\int_t^T r_udu\right\}\right).\]</span>
An advantage of the CIR model is that the above discounting has a closed-form:
<span class="math display">\[\begin{align*}
B_t(T) &amp;= b_1(T)e^{-b_2(T)r_0}\\
b_1(T) &amp;= \left(\frac{2\gamma \exp((\kappa_r+\gamma)T/2)}{2\gamma + (\kappa_r + \gamma)(e^{\gamma T}-1)}\right)^{\frac{2\kappa_r\theta_r}{\sigma_r^2}}\\
b_2(T) &amp;= \frac{2(e^{\gamma T}-1)}{2\gamma + (\kappa_r + \gamma)(e^{\gamma T}-1)}\\
\gamma = \sqrt{\kappa_r^2 + 2\sigma_r^2}
\end{align*}\]</span></p>
<p>The following python codes implement discounting under the CIR model.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="a-flexible-derivative-pricing-model.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb15-2"><a href="a-flexible-derivative-pricing-model.html#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb15-3"><a href="a-flexible-derivative-pricing-model.html#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="a-flexible-derivative-pricing-model.html#cb15-4" aria-hidden="true" tabindex="-1"></a>kappa_r, theta_r, sigma_r, r0, T <span class="op">=</span> <span class="fl">0.3</span>, <span class="fl">0.04</span>, <span class="fl">0.1</span>, <span class="fl">0.04</span>, <span class="fl">1.0</span></span>
<span id="cb15-5"><a href="a-flexible-derivative-pricing-model.html#cb15-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-6"><a href="a-flexible-derivative-pricing-model.html#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> gamma(kappa_r, sigma_r):</span>
<span id="cb15-7"><a href="a-flexible-derivative-pricing-model.html#cb15-7" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Help Function. '''</span></span>
<span id="cb15-8"><a href="a-flexible-derivative-pricing-model.html#cb15-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> math.sqrt(kappa_r <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">*</span> sigma_r <span class="op">**</span> <span class="dv">2</span>)</span>
<span id="cb15-9"><a href="a-flexible-derivative-pricing-model.html#cb15-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-10"><a href="a-flexible-derivative-pricing-model.html#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> b1(alpha):</span>
<span id="cb15-11"><a href="a-flexible-derivative-pricing-model.html#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Help Function. '''</span></span>
<span id="cb15-12"><a href="a-flexible-derivative-pricing-model.html#cb15-12" aria-hidden="true" tabindex="-1"></a>  kappa_r, theta_r, sigma_r, r0, T <span class="op">=</span> alpha</span>
<span id="cb15-13"><a href="a-flexible-derivative-pricing-model.html#cb15-13" aria-hidden="true" tabindex="-1"></a>  g <span class="op">=</span> gamma(kappa_r, sigma_r)</span>
<span id="cb15-14"><a href="a-flexible-derivative-pricing-model.html#cb15-14" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (((<span class="dv">2</span> <span class="op">*</span> g <span class="op">*</span> math.exp((kappa_r <span class="op">+</span> g) <span class="op">*</span> T <span class="op">/</span> <span class="dv">2</span>)) <span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span> g <span class="op">+</span> (kappa_r <span class="op">+</span> g) <span class="op">*</span> (math.exp(g <span class="op">*</span> T) <span class="op">-</span> <span class="dv">1</span>)))<span class="op">**</span> (<span class="dv">2</span> <span class="op">*</span> kappa_r <span class="op">*</span> theta_r <span class="op">/</span> sigma_r <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb15-15"><a href="a-flexible-derivative-pricing-model.html#cb15-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-16"><a href="a-flexible-derivative-pricing-model.html#cb15-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-17"><a href="a-flexible-derivative-pricing-model.html#cb15-17" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> b2(alpha):</span>
<span id="cb15-18"><a href="a-flexible-derivative-pricing-model.html#cb15-18" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Help Function. '''</span></span>
<span id="cb15-19"><a href="a-flexible-derivative-pricing-model.html#cb15-19" aria-hidden="true" tabindex="-1"></a>  kappa_r, theta_r, sigma_r, r0, T <span class="op">=</span> alpha</span>
<span id="cb15-20"><a href="a-flexible-derivative-pricing-model.html#cb15-20" aria-hidden="true" tabindex="-1"></a>  g <span class="op">=</span> gamma(kappa_r, sigma_r)</span>
<span id="cb15-21"><a href="a-flexible-derivative-pricing-model.html#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ((<span class="dv">2</span> <span class="op">*</span> (math.exp(g <span class="op">*</span> T) <span class="op">-</span> <span class="dv">1</span>)) <span class="op">/</span>(<span class="dv">2</span> <span class="op">*</span> g <span class="op">+</span> (kappa_r <span class="op">+</span> g) <span class="op">*</span> (math.exp(g <span class="op">*</span> T) <span class="op">-</span> <span class="dv">1</span>)))</span>
<span id="cb15-22"><a href="a-flexible-derivative-pricing-model.html#cb15-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-23"><a href="a-flexible-derivative-pricing-model.html#cb15-23" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> B(alpha):</span>
<span id="cb15-24"><a href="a-flexible-derivative-pricing-model.html#cb15-24" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Function to value unit zero-coupon bonds in Cox-Ingersoll-Ross (1985)</span></span>
<span id="cb15-25"><a href="a-flexible-derivative-pricing-model.html#cb15-25" aria-hidden="true" tabindex="-1"></a><span class="co">  model.</span></span>
<span id="cb15-26"><a href="a-flexible-derivative-pricing-model.html#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb15-27"><a href="a-flexible-derivative-pricing-model.html#cb15-27" aria-hidden="true" tabindex="-1"></a><span class="co">  ==========</span></span>
<span id="cb15-28"><a href="a-flexible-derivative-pricing-model.html#cb15-28" aria-hidden="true" tabindex="-1"></a><span class="co">  r0: float</span></span>
<span id="cb15-29"><a href="a-flexible-derivative-pricing-model.html#cb15-29" aria-hidden="true" tabindex="-1"></a><span class="co">  initial short rate</span></span>
<span id="cb15-30"><a href="a-flexible-derivative-pricing-model.html#cb15-30" aria-hidden="true" tabindex="-1"></a><span class="co">  kappa_r: float</span></span>
<span id="cb15-31"><a href="a-flexible-derivative-pricing-model.html#cb15-31" aria-hidden="true" tabindex="-1"></a><span class="co">  mean-reversion factor</span></span>
<span id="cb15-32"><a href="a-flexible-derivative-pricing-model.html#cb15-32" aria-hidden="true" tabindex="-1"></a><span class="co">  theta_r: float</span></span>
<span id="cb15-33"><a href="a-flexible-derivative-pricing-model.html#cb15-33" aria-hidden="true" tabindex="-1"></a><span class="co">  long-run mean of short rate</span></span>
<span id="cb15-34"><a href="a-flexible-derivative-pricing-model.html#cb15-34" aria-hidden="true" tabindex="-1"></a><span class="co">  sigma_r: float</span></span>
<span id="cb15-35"><a href="a-flexible-derivative-pricing-model.html#cb15-35" aria-hidden="true" tabindex="-1"></a><span class="co">  volatility of short rate</span></span>
<span id="cb15-36"><a href="a-flexible-derivative-pricing-model.html#cb15-36" aria-hidden="true" tabindex="-1"></a><span class="co">  T: float</span></span>
<span id="cb15-37"><a href="a-flexible-derivative-pricing-model.html#cb15-37" aria-hidden="true" tabindex="-1"></a><span class="co">  time horizon/interval</span></span>
<span id="cb15-38"><a href="a-flexible-derivative-pricing-model.html#cb15-38" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb15-39"><a href="a-flexible-derivative-pricing-model.html#cb15-39" aria-hidden="true" tabindex="-1"></a><span class="co">  =======</span></span>
<span id="cb15-40"><a href="a-flexible-derivative-pricing-model.html#cb15-40" aria-hidden="true" tabindex="-1"></a><span class="co">  zcb_value: float</span></span>
<span id="cb15-41"><a href="a-flexible-derivative-pricing-model.html#cb15-41" aria-hidden="true" tabindex="-1"></a><span class="co">  zero-coupon bond present value</span></span>
<span id="cb15-42"><a href="a-flexible-derivative-pricing-model.html#cb15-42" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb15-43"><a href="a-flexible-derivative-pricing-model.html#cb15-43" aria-hidden="true" tabindex="-1"></a>  b_1 <span class="op">=</span> b1(alpha)</span>
<span id="cb15-44"><a href="a-flexible-derivative-pricing-model.html#cb15-44" aria-hidden="true" tabindex="-1"></a>  b_2 <span class="op">=</span> b2(alpha)</span>
<span id="cb15-45"><a href="a-flexible-derivative-pricing-model.html#cb15-45" aria-hidden="true" tabindex="-1"></a>  kappa_r, theta_r, sigma_r, r0, T <span class="op">=</span> alpha</span>
<span id="cb15-46"><a href="a-flexible-derivative-pricing-model.html#cb15-46" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> b_1 <span class="op">*</span> math.exp(<span class="op">-</span>b_2 <span class="op">*</span> r0)</span>
<span id="cb15-47"><a href="a-flexible-derivative-pricing-model.html#cb15-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-48"><a href="a-flexible-derivative-pricing-model.html#cb15-48" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb15-49"><a href="a-flexible-derivative-pricing-model.html#cb15-49" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb15-50"><a href="a-flexible-derivative-pricing-model.html#cb15-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example Valuation</span></span>
<span id="cb15-51"><a href="a-flexible-derivative-pricing-model.html#cb15-51" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb15-52"><a href="a-flexible-derivative-pricing-model.html#cb15-52" aria-hidden="true" tabindex="-1"></a>  B0T <span class="op">=</span> B([kappa_r, theta_r, sigma_r, r0, T])</span>
<span id="cb15-53"><a href="a-flexible-derivative-pricing-model.html#cb15-53" aria-hidden="true" tabindex="-1"></a>  <span class="co"># discount factor, ZCB value</span></span>
<span id="cb15-54"><a href="a-flexible-derivative-pricing-model.html#cb15-54" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"ZCB Value </span><span class="sc">%10.4f</span><span class="st">"</span> <span class="op">%</span> B0T)</span></code></pre></div>
<pre><code>## ZCB Value     0.9608</code></pre>
</div>
<div id="evaluating-a-european-option-via-fourier-transform" class="section level2" number="5.2">
<h2>
<span class="header-section-number">5.2</span> Evaluating a European option via Fourier transform<a class="anchor" aria-label="anchor" href="#evaluating-a-european-option-via-fourier-transform"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="a-flexible-derivative-pricing-model.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="a-flexible-derivative-pricing-model.html#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.integrate <span class="im">import</span> quad</span>
<span id="cb17-3"><a href="a-flexible-derivative-pricing-model.html#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> warnings</span>
<span id="cb17-4"><a href="a-flexible-derivative-pricing-model.html#cb17-4" aria-hidden="true" tabindex="-1"></a>warnings.simplefilter(<span class="st">'ignore'</span>)</span>
<span id="cb17-5"><a href="a-flexible-derivative-pricing-model.html#cb17-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-6"><a href="a-flexible-derivative-pricing-model.html#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-7"><a href="a-flexible-derivative-pricing-model.html#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Example Parameters B96 Model</span></span>
<span id="cb17-8"><a href="a-flexible-derivative-pricing-model.html#cb17-8" aria-hidden="true" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb17-9"><a href="a-flexible-derivative-pricing-model.html#cb17-9" aria-hidden="true" tabindex="-1"></a><span class="co">## H93 Parameters</span></span>
<span id="cb17-10"><a href="a-flexible-derivative-pricing-model.html#cb17-10" aria-hidden="true" tabindex="-1"></a>kappa_v <span class="op">=</span> <span class="fl">1.5</span></span>
<span id="cb17-11"><a href="a-flexible-derivative-pricing-model.html#cb17-11" aria-hidden="true" tabindex="-1"></a>theta_v <span class="op">=</span> <span class="fl">0.02</span></span>
<span id="cb17-12"><a href="a-flexible-derivative-pricing-model.html#cb17-12" aria-hidden="true" tabindex="-1"></a>sigma_v <span class="op">=</span> <span class="fl">0.15</span></span>
<span id="cb17-13"><a href="a-flexible-derivative-pricing-model.html#cb17-13" aria-hidden="true" tabindex="-1"></a>rho <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb17-14"><a href="a-flexible-derivative-pricing-model.html#cb17-14" aria-hidden="true" tabindex="-1"></a>v0 <span class="op">=</span> <span class="fl">0.01</span></span>
<span id="cb17-15"><a href="a-flexible-derivative-pricing-model.html#cb17-15" aria-hidden="true" tabindex="-1"></a><span class="co">## M76 Parameters</span></span>
<span id="cb17-16"><a href="a-flexible-derivative-pricing-model.html#cb17-16" aria-hidden="true" tabindex="-1"></a>lamb <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb17-17"><a href="a-flexible-derivative-pricing-model.html#cb17-17" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> <span class="op">-</span><span class="fl">0.2</span></span>
<span id="cb17-18"><a href="a-flexible-derivative-pricing-model.html#cb17-18" aria-hidden="true" tabindex="-1"></a>delta <span class="op">=</span> <span class="fl">0.1</span></span>
<span id="cb17-19"><a href="a-flexible-derivative-pricing-model.html#cb17-19" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> np.sqrt(v0)</span>
<span id="cb17-20"><a href="a-flexible-derivative-pricing-model.html#cb17-20" aria-hidden="true" tabindex="-1"></a><span class="co">## General Parameters</span></span>
<span id="cb17-21"><a href="a-flexible-derivative-pricing-model.html#cb17-21" aria-hidden="true" tabindex="-1"></a>S0 <span class="op">=</span> <span class="fl">100.0</span></span>
<span id="cb17-22"><a href="a-flexible-derivative-pricing-model.html#cb17-22" aria-hidden="true" tabindex="-1"></a>K <span class="op">=</span> <span class="fl">100.0</span></span>
<span id="cb17-23"><a href="a-flexible-derivative-pricing-model.html#cb17-23" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">1.0</span></span>
<span id="cb17-24"><a href="a-flexible-derivative-pricing-model.html#cb17-24" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb17-25"><a href="a-flexible-derivative-pricing-model.html#cb17-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-26"><a href="a-flexible-derivative-pricing-model.html#cb17-26" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BCC_call_value(S0, K, T, r, kappa_v, theta_v, sigma_v, rho, v0, lamb, mu, delta):</span>
<span id="cb17-27"><a href="a-flexible-derivative-pricing-model.html#cb17-27" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in B96 Model via Lewis (2001)</span></span>
<span id="cb17-28"><a href="a-flexible-derivative-pricing-model.html#cb17-28" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach.</span></span>
<span id="cb17-29"><a href="a-flexible-derivative-pricing-model.html#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb17-30"><a href="a-flexible-derivative-pricing-model.html#cb17-30" aria-hidden="true" tabindex="-1"></a><span class="co">  ==========</span></span>
<span id="cb17-31"><a href="a-flexible-derivative-pricing-model.html#cb17-31" aria-hidden="true" tabindex="-1"></a><span class="co">  S0: float</span></span>
<span id="cb17-32"><a href="a-flexible-derivative-pricing-model.html#cb17-32" aria-hidden="true" tabindex="-1"></a><span class="co">  initial stock/index level</span></span>
<span id="cb17-33"><a href="a-flexible-derivative-pricing-model.html#cb17-33" aria-hidden="true" tabindex="-1"></a><span class="co">  K: float</span></span>
<span id="cb17-34"><a href="a-flexible-derivative-pricing-model.html#cb17-34" aria-hidden="true" tabindex="-1"></a><span class="co">  strike price</span></span>
<span id="cb17-35"><a href="a-flexible-derivative-pricing-model.html#cb17-35" aria-hidden="true" tabindex="-1"></a><span class="co">  T: float</span></span>
<span id="cb17-36"><a href="a-flexible-derivative-pricing-model.html#cb17-36" aria-hidden="true" tabindex="-1"></a><span class="co">  time-to-maturity (for t=0)</span></span>
<span id="cb17-37"><a href="a-flexible-derivative-pricing-model.html#cb17-37" aria-hidden="true" tabindex="-1"></a><span class="co">  r: float</span></span>
<span id="cb17-38"><a href="a-flexible-derivative-pricing-model.html#cb17-38" aria-hidden="true" tabindex="-1"></a><span class="co">  constant risk-free short rate</span></span>
<span id="cb17-39"><a href="a-flexible-derivative-pricing-model.html#cb17-39" aria-hidden="true" tabindex="-1"></a><span class="co">  kappa_v: float</span></span>
<span id="cb17-40"><a href="a-flexible-derivative-pricing-model.html#cb17-40" aria-hidden="true" tabindex="-1"></a><span class="co">  mean-reversion factor</span></span>
<span id="cb17-41"><a href="a-flexible-derivative-pricing-model.html#cb17-41" aria-hidden="true" tabindex="-1"></a><span class="co">  theta_v: float</span></span>
<span id="cb17-42"><a href="a-flexible-derivative-pricing-model.html#cb17-42" aria-hidden="true" tabindex="-1"></a><span class="co">  long-run mean of variance</span></span>
<span id="cb17-43"><a href="a-flexible-derivative-pricing-model.html#cb17-43" aria-hidden="true" tabindex="-1"></a><span class="co">  sigma_v: float</span></span>
<span id="cb17-44"><a href="a-flexible-derivative-pricing-model.html#cb17-44" aria-hidden="true" tabindex="-1"></a><span class="co">  volatility of variance</span></span>
<span id="cb17-45"><a href="a-flexible-derivative-pricing-model.html#cb17-45" aria-hidden="true" tabindex="-1"></a><span class="co">  rho: float</span></span>
<span id="cb17-46"><a href="a-flexible-derivative-pricing-model.html#cb17-46" aria-hidden="true" tabindex="-1"></a><span class="co">  correlation between variance and stock/index level</span></span>
<span id="cb17-47"><a href="a-flexible-derivative-pricing-model.html#cb17-47" aria-hidden="true" tabindex="-1"></a><span class="co">  v0: float</span></span>
<span id="cb17-48"><a href="a-flexible-derivative-pricing-model.html#cb17-48" aria-hidden="true" tabindex="-1"></a><span class="co">  initial level of variance</span></span>
<span id="cb17-49"><a href="a-flexible-derivative-pricing-model.html#cb17-49" aria-hidden="true" tabindex="-1"></a><span class="co">  lamb: float</span></span>
<span id="cb17-50"><a href="a-flexible-derivative-pricing-model.html#cb17-50" aria-hidden="true" tabindex="-1"></a><span class="co">  jump intensity</span></span>
<span id="cb17-51"><a href="a-flexible-derivative-pricing-model.html#cb17-51" aria-hidden="true" tabindex="-1"></a><span class="co">  mu: float</span></span>
<span id="cb17-52"><a href="a-flexible-derivative-pricing-model.html#cb17-52" aria-hidden="true" tabindex="-1"></a><span class="co">  expected jump size</span></span>
<span id="cb17-53"><a href="a-flexible-derivative-pricing-model.html#cb17-53" aria-hidden="true" tabindex="-1"></a><span class="co">  delta: float</span></span>
<span id="cb17-54"><a href="a-flexible-derivative-pricing-model.html#cb17-54" aria-hidden="true" tabindex="-1"></a><span class="co">  standard deviation of jump</span></span>
<span id="cb17-55"><a href="a-flexible-derivative-pricing-model.html#cb17-55" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb17-56"><a href="a-flexible-derivative-pricing-model.html#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co">  =======</span></span>
<span id="cb17-57"><a href="a-flexible-derivative-pricing-model.html#cb17-57" aria-hidden="true" tabindex="-1"></a><span class="co">  call_value: float</span></span>
<span id="cb17-58"><a href="a-flexible-derivative-pricing-model.html#cb17-58" aria-hidden="true" tabindex="-1"></a><span class="co">  present value of European call option</span></span>
<span id="cb17-59"><a href="a-flexible-derivative-pricing-model.html#cb17-59" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb17-60"><a href="a-flexible-derivative-pricing-model.html#cb17-60" aria-hidden="true" tabindex="-1"></a>  int_value <span class="op">=</span> quad(<span class="kw">lambda</span> u: BCC_int_func(u, S0, K, T, r, kappa_v, theta_v,sigma_v, rho, v0, lamb, mu, delta), <span class="dv">0</span>, np.inf,limit<span class="op">=</span><span class="dv">250</span>)[<span class="dv">0</span>]</span>
<span id="cb17-61"><a href="a-flexible-derivative-pricing-model.html#cb17-61" aria-hidden="true" tabindex="-1"></a>  call_value <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, S0 <span class="op">-</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> np.sqrt(S0 <span class="op">*</span> K)<span class="op">/</span> np.pi <span class="op">*</span> int_value)</span>
<span id="cb17-62"><a href="a-flexible-derivative-pricing-model.html#cb17-62" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> call_value</span>
<span id="cb17-63"><a href="a-flexible-derivative-pricing-model.html#cb17-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-64"><a href="a-flexible-derivative-pricing-model.html#cb17-64" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> H93_call_value(S0, K, T, r, kappa_v, theta_v, sigma_v, rho, v0):</span>
<span id="cb17-65"><a href="a-flexible-derivative-pricing-model.html#cb17-65" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in H93 model via Lewis (2001)</span></span>
<span id="cb17-66"><a href="a-flexible-derivative-pricing-model.html#cb17-66" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach.</span></span>
<span id="cb17-67"><a href="a-flexible-derivative-pricing-model.html#cb17-67" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb17-68"><a href="a-flexible-derivative-pricing-model.html#cb17-68" aria-hidden="true" tabindex="-1"></a><span class="co">  ==========</span></span>
<span id="cb17-69"><a href="a-flexible-derivative-pricing-model.html#cb17-69" aria-hidden="true" tabindex="-1"></a><span class="co">  S0: float</span></span>
<span id="cb17-70"><a href="a-flexible-derivative-pricing-model.html#cb17-70" aria-hidden="true" tabindex="-1"></a><span class="co">  initial stock/index level</span></span>
<span id="cb17-71"><a href="a-flexible-derivative-pricing-model.html#cb17-71" aria-hidden="true" tabindex="-1"></a><span class="co">  K: float</span></span>
<span id="cb17-72"><a href="a-flexible-derivative-pricing-model.html#cb17-72" aria-hidden="true" tabindex="-1"></a><span class="co">  strike price</span></span>
<span id="cb17-73"><a href="a-flexible-derivative-pricing-model.html#cb17-73" aria-hidden="true" tabindex="-1"></a><span class="co">  T: float</span></span>
<span id="cb17-74"><a href="a-flexible-derivative-pricing-model.html#cb17-74" aria-hidden="true" tabindex="-1"></a><span class="co">  time-to-maturity (for t=0)</span></span>
<span id="cb17-75"><a href="a-flexible-derivative-pricing-model.html#cb17-75" aria-hidden="true" tabindex="-1"></a><span class="co">  r: float</span></span>
<span id="cb17-76"><a href="a-flexible-derivative-pricing-model.html#cb17-76" aria-hidden="true" tabindex="-1"></a><span class="co">  constant risk-free short rate</span></span>
<span id="cb17-77"><a href="a-flexible-derivative-pricing-model.html#cb17-77" aria-hidden="true" tabindex="-1"></a><span class="co">  kappa_v: float</span></span>
<span id="cb17-78"><a href="a-flexible-derivative-pricing-model.html#cb17-78" aria-hidden="true" tabindex="-1"></a><span class="co">  mean-reversion factor</span></span>
<span id="cb17-79"><a href="a-flexible-derivative-pricing-model.html#cb17-79" aria-hidden="true" tabindex="-1"></a><span class="co">  theta_v: float</span></span>
<span id="cb17-80"><a href="a-flexible-derivative-pricing-model.html#cb17-80" aria-hidden="true" tabindex="-1"></a><span class="co">  long-run mean of variance</span></span>
<span id="cb17-81"><a href="a-flexible-derivative-pricing-model.html#cb17-81" aria-hidden="true" tabindex="-1"></a><span class="co">  sigma_v: float</span></span>
<span id="cb17-82"><a href="a-flexible-derivative-pricing-model.html#cb17-82" aria-hidden="true" tabindex="-1"></a><span class="co">  volatility of variance</span></span>
<span id="cb17-83"><a href="a-flexible-derivative-pricing-model.html#cb17-83" aria-hidden="true" tabindex="-1"></a><span class="co">  rho: float</span></span>
<span id="cb17-84"><a href="a-flexible-derivative-pricing-model.html#cb17-84" aria-hidden="true" tabindex="-1"></a><span class="co">  correlation between variance and stock/index level</span></span>
<span id="cb17-85"><a href="a-flexible-derivative-pricing-model.html#cb17-85" aria-hidden="true" tabindex="-1"></a><span class="co">  v0: float</span></span>
<span id="cb17-86"><a href="a-flexible-derivative-pricing-model.html#cb17-86" aria-hidden="true" tabindex="-1"></a><span class="co">  initial level of variance</span></span>
<span id="cb17-87"><a href="a-flexible-derivative-pricing-model.html#cb17-87" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb17-88"><a href="a-flexible-derivative-pricing-model.html#cb17-88" aria-hidden="true" tabindex="-1"></a><span class="co">  =======</span></span>
<span id="cb17-89"><a href="a-flexible-derivative-pricing-model.html#cb17-89" aria-hidden="true" tabindex="-1"></a><span class="co">  call_value: float</span></span>
<span id="cb17-90"><a href="a-flexible-derivative-pricing-model.html#cb17-90" aria-hidden="true" tabindex="-1"></a><span class="co">  present value of European call option</span></span>
<span id="cb17-91"><a href="a-flexible-derivative-pricing-model.html#cb17-91" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb17-92"><a href="a-flexible-derivative-pricing-model.html#cb17-92" aria-hidden="true" tabindex="-1"></a>  int_value <span class="op">=</span> quad(<span class="kw">lambda</span> u: H93_int_func(u, S0, K, T, r, kappa_v, theta_v, sigma_v, rho, v0), <span class="dv">0</span>, np.inf, limit<span class="op">=</span><span class="dv">250</span>)[<span class="dv">0</span>]</span>
<span id="cb17-93"><a href="a-flexible-derivative-pricing-model.html#cb17-93" aria-hidden="true" tabindex="-1"></a>  call_value <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, S0 <span class="op">-</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> np.sqrt(S0 <span class="op">*</span> K)<span class="op">/</span> np.pi <span class="op">*</span> int_value)</span>
<span id="cb17-94"><a href="a-flexible-derivative-pricing-model.html#cb17-94" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> call_value</span>
<span id="cb17-95"><a href="a-flexible-derivative-pricing-model.html#cb17-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-96"><a href="a-flexible-derivative-pricing-model.html#cb17-96" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> M76_call_value(S0, K, T, r, v0, lamb, mu, delta):</span>
<span id="cb17-97"><a href="a-flexible-derivative-pricing-model.html#cb17-97" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in M76 model via Lewis (2001)</span></span>
<span id="cb17-98"><a href="a-flexible-derivative-pricing-model.html#cb17-98" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach.</span></span>
<span id="cb17-99"><a href="a-flexible-derivative-pricing-model.html#cb17-99" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameters</span></span>
<span id="cb17-100"><a href="a-flexible-derivative-pricing-model.html#cb17-100" aria-hidden="true" tabindex="-1"></a><span class="co">  ==========</span></span>
<span id="cb17-101"><a href="a-flexible-derivative-pricing-model.html#cb17-101" aria-hidden="true" tabindex="-1"></a><span class="co">  S0: float</span></span>
<span id="cb17-102"><a href="a-flexible-derivative-pricing-model.html#cb17-102" aria-hidden="true" tabindex="-1"></a><span class="co">  initial stock/index level</span></span>
<span id="cb17-103"><a href="a-flexible-derivative-pricing-model.html#cb17-103" aria-hidden="true" tabindex="-1"></a><span class="co">  K: float</span></span>
<span id="cb17-104"><a href="a-flexible-derivative-pricing-model.html#cb17-104" aria-hidden="true" tabindex="-1"></a><span class="co">  strike price</span></span>
<span id="cb17-105"><a href="a-flexible-derivative-pricing-model.html#cb17-105" aria-hidden="true" tabindex="-1"></a><span class="co">  T: float</span></span>
<span id="cb17-106"><a href="a-flexible-derivative-pricing-model.html#cb17-106" aria-hidden="true" tabindex="-1"></a><span class="co">  time-to-maturity (for t=0)</span></span>
<span id="cb17-107"><a href="a-flexible-derivative-pricing-model.html#cb17-107" aria-hidden="true" tabindex="-1"></a><span class="co">  r: float</span></span>
<span id="cb17-108"><a href="a-flexible-derivative-pricing-model.html#cb17-108" aria-hidden="true" tabindex="-1"></a><span class="co">  constant risk-free short rate</span></span>
<span id="cb17-109"><a href="a-flexible-derivative-pricing-model.html#cb17-109" aria-hidden="true" tabindex="-1"></a><span class="co">  lamb: float</span></span>
<span id="cb17-110"><a href="a-flexible-derivative-pricing-model.html#cb17-110" aria-hidden="true" tabindex="-1"></a><span class="co">  jump intensity</span></span>
<span id="cb17-111"><a href="a-flexible-derivative-pricing-model.html#cb17-111" aria-hidden="true" tabindex="-1"></a><span class="co">  mu: float</span></span>
<span id="cb17-112"><a href="a-flexible-derivative-pricing-model.html#cb17-112" aria-hidden="true" tabindex="-1"></a><span class="co">  expected jump size</span></span>
<span id="cb17-113"><a href="a-flexible-derivative-pricing-model.html#cb17-113" aria-hidden="true" tabindex="-1"></a><span class="co">  delta: float</span></span>
<span id="cb17-114"><a href="a-flexible-derivative-pricing-model.html#cb17-114" aria-hidden="true" tabindex="-1"></a><span class="co">  standard deviation of jump</span></span>
<span id="cb17-115"><a href="a-flexible-derivative-pricing-model.html#cb17-115" aria-hidden="true" tabindex="-1"></a><span class="co">  Returns</span></span>
<span id="cb17-116"><a href="a-flexible-derivative-pricing-model.html#cb17-116" aria-hidden="true" tabindex="-1"></a><span class="co">  =======</span></span>
<span id="cb17-117"><a href="a-flexible-derivative-pricing-model.html#cb17-117" aria-hidden="true" tabindex="-1"></a><span class="co">  call_value: float</span></span>
<span id="cb17-118"><a href="a-flexible-derivative-pricing-model.html#cb17-118" aria-hidden="true" tabindex="-1"></a><span class="co">  present value of European call option</span></span>
<span id="cb17-119"><a href="a-flexible-derivative-pricing-model.html#cb17-119" aria-hidden="true" tabindex="-1"></a><span class="co">  '''</span></span>
<span id="cb17-120"><a href="a-flexible-derivative-pricing-model.html#cb17-120" aria-hidden="true" tabindex="-1"></a>  sigma <span class="op">=</span> np.sqrt(v0)</span>
<span id="cb17-121"><a href="a-flexible-derivative-pricing-model.html#cb17-121" aria-hidden="true" tabindex="-1"></a>  int_value <span class="op">=</span> quad(<span class="kw">lambda</span> u: M76_int_func_sa(u, S0, K, T, r,</span>
<span id="cb17-122"><a href="a-flexible-derivative-pricing-model.html#cb17-122" aria-hidden="true" tabindex="-1"></a>  sigma, lamb, mu, delta), <span class="dv">0</span>, np.inf, limit<span class="op">=</span><span class="dv">250</span>)[<span class="dv">0</span>]</span>
<span id="cb17-123"><a href="a-flexible-derivative-pricing-model.html#cb17-123" aria-hidden="true" tabindex="-1"></a>  call_value <span class="op">=</span> <span class="bu">max</span>(<span class="dv">0</span>, S0 <span class="op">-</span> np.exp(<span class="op">-</span>r <span class="op">*</span> T) <span class="op">*</span> np.sqrt(S0 <span class="op">*</span> K)<span class="op">/</span> np.pi <span class="op">*</span> int_value)</span>
<span id="cb17-124"><a href="a-flexible-derivative-pricing-model.html#cb17-124" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> call_value</span>
<span id="cb17-125"><a href="a-flexible-derivative-pricing-model.html#cb17-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-126"><a href="a-flexible-derivative-pricing-model.html#cb17-126" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BCC_int_func(u, S0, K, T, r, kappa_v, theta_v, sigma_v, rho, v0,lamb, mu, delta):</span>
<span id="cb17-127"><a href="a-flexible-derivative-pricing-model.html#cb17-127" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in BCC97 model via Lewis (2001)</span></span>
<span id="cb17-128"><a href="a-flexible-derivative-pricing-model.html#cb17-128" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: integration function.</span></span>
<span id="cb17-129"><a href="a-flexible-derivative-pricing-model.html#cb17-129" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function BCC_call_value.'''</span></span>
<span id="cb17-130"><a href="a-flexible-derivative-pricing-model.html#cb17-130" aria-hidden="true" tabindex="-1"></a>  char_func_value <span class="op">=</span> BCC_char_func(u <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> <span class="fl">0.5</span>, T, r, kappa_v, theta_v, sigma_v, rho, v0, lamb, mu, delta)</span>
<span id="cb17-131"><a href="a-flexible-derivative-pricing-model.html#cb17-131" aria-hidden="true" tabindex="-1"></a>  int_func_value <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (u <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.25</span>) <span class="op">*</span> (np.exp(<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> np.log(S0 <span class="op">/</span> K)) <span class="op">*</span> char_func_value).real</span>
<span id="cb17-132"><a href="a-flexible-derivative-pricing-model.html#cb17-132" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> int_func_value</span>
<span id="cb17-133"><a href="a-flexible-derivative-pricing-model.html#cb17-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-134"><a href="a-flexible-derivative-pricing-model.html#cb17-134" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> H93_int_func(u, S0, K, T, r, kappa_v, theta_v, sigma_v, rho, v0):</span>
<span id="cb17-135"><a href="a-flexible-derivative-pricing-model.html#cb17-135" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in H93 model via Lewis (2001)</span></span>
<span id="cb17-136"><a href="a-flexible-derivative-pricing-model.html#cb17-136" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: integration function.</span></span>
<span id="cb17-137"><a href="a-flexible-derivative-pricing-model.html#cb17-137" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function H93_call_value.'''</span></span>
<span id="cb17-138"><a href="a-flexible-derivative-pricing-model.html#cb17-138" aria-hidden="true" tabindex="-1"></a>  char_func_value <span class="op">=</span> H93_char_func(u <span class="op">-</span> <span class="ot">1j</span> <span class="op">*</span> <span class="fl">0.5</span>, T, r, kappa_v, theta_v, sigma_v, rho, v0)</span>
<span id="cb17-139"><a href="a-flexible-derivative-pricing-model.html#cb17-139" aria-hidden="true" tabindex="-1"></a>  int_func_value <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (u <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.25</span>) <span class="op">*</span> (np.exp(<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> np.log(S0 <span class="op">/</span> K)) <span class="op">*</span> char_func_value).real</span>
<span id="cb17-140"><a href="a-flexible-derivative-pricing-model.html#cb17-140" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> int_func_value</span>
<span id="cb17-141"><a href="a-flexible-derivative-pricing-model.html#cb17-141" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-142"><a href="a-flexible-derivative-pricing-model.html#cb17-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-143"><a href="a-flexible-derivative-pricing-model.html#cb17-143" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> M76_int_func_sa(u, S0, K, T, r, sigma, lamb, mu, delta):</span>
<span id="cb17-144"><a href="a-flexible-derivative-pricing-model.html#cb17-144" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in M76 model via Lewis (2001)</span></span>
<span id="cb17-145"><a href="a-flexible-derivative-pricing-model.html#cb17-145" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: integration function.</span></span>
<span id="cb17-146"><a href="a-flexible-derivative-pricing-model.html#cb17-146" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function M76_call_value.'''</span></span>
<span id="cb17-147"><a href="a-flexible-derivative-pricing-model.html#cb17-147" aria-hidden="true" tabindex="-1"></a>  char_func_value <span class="op">=</span> M76_char_func_sa(u <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> <span class="ot">1j</span>, T, r, sigma, lamb, mu, delta)</span>
<span id="cb17-148"><a href="a-flexible-derivative-pricing-model.html#cb17-148" aria-hidden="true" tabindex="-1"></a>  int_func_value <span class="op">=</span> <span class="dv">1</span> <span class="op">/</span> (u <span class="op">**</span> <span class="dv">2</span> <span class="op">+</span> <span class="fl">0.25</span>) <span class="op">*</span> (np.exp(<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> np.log(S0 <span class="op">/</span> K)) <span class="op">*</span> char_func_value).real</span>
<span id="cb17-149"><a href="a-flexible-derivative-pricing-model.html#cb17-149" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> int_func_value</span>
<span id="cb17-150"><a href="a-flexible-derivative-pricing-model.html#cb17-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-151"><a href="a-flexible-derivative-pricing-model.html#cb17-151" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> BCC_char_func(u, T, r, kappa_v, theta_v, sigma_v, rho, v0,lamb, mu, delta):</span>
<span id="cb17-152"><a href="a-flexible-derivative-pricing-model.html#cb17-152" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in BCC97 model via Lewis (2001)</span></span>
<span id="cb17-153"><a href="a-flexible-derivative-pricing-model.html#cb17-153" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: characteristic function.</span></span>
<span id="cb17-154"><a href="a-flexible-derivative-pricing-model.html#cb17-154" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function BCC_call_value.'''</span></span>
<span id="cb17-155"><a href="a-flexible-derivative-pricing-model.html#cb17-155" aria-hidden="true" tabindex="-1"></a>  BCC1 <span class="op">=</span> H93_char_func(u, T, r, kappa_v, theta_v, sigma_v, rho, v0)</span>
<span id="cb17-156"><a href="a-flexible-derivative-pricing-model.html#cb17-156" aria-hidden="true" tabindex="-1"></a>  BCC2 <span class="op">=</span> M76_char_func(u, T, lamb, mu, delta)</span>
<span id="cb17-157"><a href="a-flexible-derivative-pricing-model.html#cb17-157" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> BCC1 <span class="op">*</span> BCC2</span>
<span id="cb17-158"><a href="a-flexible-derivative-pricing-model.html#cb17-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-159"><a href="a-flexible-derivative-pricing-model.html#cb17-159" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> H93_char_func(u, T, r, kappa_v, theta_v, sigma_v, rho, v0):</span>
<span id="cb17-160"><a href="a-flexible-derivative-pricing-model.html#cb17-160" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in H93 model via Lewis (2001)</span></span>
<span id="cb17-161"><a href="a-flexible-derivative-pricing-model.html#cb17-161" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: characteristic function.</span></span>
<span id="cb17-162"><a href="a-flexible-derivative-pricing-model.html#cb17-162" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function BCC_call_value.'''</span></span>
<span id="cb17-163"><a href="a-flexible-derivative-pricing-model.html#cb17-163" aria-hidden="true" tabindex="-1"></a>  c1 <span class="op">=</span> kappa_v <span class="op">*</span> theta_v</span>
<span id="cb17-164"><a href="a-flexible-derivative-pricing-model.html#cb17-164" aria-hidden="true" tabindex="-1"></a>  c2 <span class="op">=</span> <span class="op">-</span>np.sqrt((rho <span class="op">*</span> sigma_v <span class="op">*</span> u <span class="op">*</span> <span class="ot">1j</span> <span class="op">-</span> kappa_v)<span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> sigma_v <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> (<span class="op">-</span>u <span class="op">*</span> <span class="ot">1j</span> <span class="op">-</span> u <span class="op">**</span> <span class="dv">2</span>))</span>
<span id="cb17-165"><a href="a-flexible-derivative-pricing-model.html#cb17-165" aria-hidden="true" tabindex="-1"></a>  c3 <span class="op">=</span> (kappa_v <span class="op">-</span> rho <span class="op">*</span> sigma_v <span class="op">*</span> u <span class="op">*</span> <span class="ot">1j</span> <span class="op">+</span> c2) <span class="op">/</span> (kappa_v <span class="op">-</span> rho <span class="op">*</span> sigma_v <span class="op">*</span> u <span class="op">*</span> <span class="ot">1j</span> <span class="op">-</span> c2)</span>
<span id="cb17-166"><a href="a-flexible-derivative-pricing-model.html#cb17-166" aria-hidden="true" tabindex="-1"></a>  H1 <span class="op">=</span> (r <span class="op">*</span> u <span class="op">*</span> <span class="ot">1j</span> <span class="op">*</span> T <span class="op">+</span> (c1 <span class="op">/</span> sigma_v <span class="op">**</span> <span class="dv">2</span>)<span class="op">*</span> ((kappa_v <span class="op">-</span> rho <span class="op">*</span> sigma_v <span class="op">*</span> u <span class="op">*</span> <span class="ot">1j</span> <span class="op">+</span> c2) <span class="op">*</span> T<span class="op">-</span> <span class="dv">2</span> <span class="op">*</span> np.log((<span class="dv">1</span> <span class="op">-</span> c3 <span class="op">*</span> np.exp(c2 <span class="op">*</span> T)) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> c3))))</span>
<span id="cb17-167"><a href="a-flexible-derivative-pricing-model.html#cb17-167" aria-hidden="true" tabindex="-1"></a>  H2 <span class="op">=</span> ((kappa_v <span class="op">-</span> rho <span class="op">*</span> sigma_v <span class="op">*</span> u <span class="op">*</span> <span class="ot">1j</span> <span class="op">+</span> c2) <span class="op">/</span> sigma_v <span class="op">**</span> <span class="dv">2</span><span class="op">*</span> ((<span class="dv">1</span> <span class="op">-</span> np.exp(c2 <span class="op">*</span> T)) <span class="op">/</span> (<span class="dv">1</span> <span class="op">-</span> c3 <span class="op">*</span> np.exp(c2 <span class="op">*</span> T))))</span>
<span id="cb17-168"><a href="a-flexible-derivative-pricing-model.html#cb17-168" aria-hidden="true" tabindex="-1"></a>  char_func_value <span class="op">=</span> np.exp(H1 <span class="op">+</span> H2 <span class="op">*</span> v0)</span>
<span id="cb17-169"><a href="a-flexible-derivative-pricing-model.html#cb17-169" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> char_func_value</span>
<span id="cb17-170"><a href="a-flexible-derivative-pricing-model.html#cb17-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-171"><a href="a-flexible-derivative-pricing-model.html#cb17-171" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> M76_char_func(u, T, lamb, mu, delta):</span>
<span id="cb17-172"><a href="a-flexible-derivative-pricing-model.html#cb17-172" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in M76 model via Lewis (2001)</span></span>
<span id="cb17-173"><a href="a-flexible-derivative-pricing-model.html#cb17-173" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: characteristic function.</span></span>
<span id="cb17-174"><a href="a-flexible-derivative-pricing-model.html#cb17-174" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function M76_call_value.'''</span></span>
<span id="cb17-175"><a href="a-flexible-derivative-pricing-model.html#cb17-175" aria-hidden="true" tabindex="-1"></a>  omega <span class="op">=</span> <span class="op">-</span>lamb <span class="op">*</span> (np.exp(mu <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> delta <span class="op">**</span> <span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb17-176"><a href="a-flexible-derivative-pricing-model.html#cb17-176" aria-hidden="true" tabindex="-1"></a>  char_func_value <span class="op">=</span> np.exp((<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> omega <span class="op">+</span> lamb <span class="op">*</span> (np.exp(<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> mu <span class="op">-</span> u <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> delta <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> <span class="fl">0.5</span>) <span class="op">-</span> <span class="dv">1</span>)) <span class="op">*</span> T)</span>
<span id="cb17-177"><a href="a-flexible-derivative-pricing-model.html#cb17-177" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> char_func_value</span>
<span id="cb17-178"><a href="a-flexible-derivative-pricing-model.html#cb17-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-179"><a href="a-flexible-derivative-pricing-model.html#cb17-179" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> M76_char_func_sa(u, T, r, sigma, lamb, mu, delta):</span>
<span id="cb17-180"><a href="a-flexible-derivative-pricing-model.html#cb17-180" aria-hidden="true" tabindex="-1"></a>  <span class="co">''' Valuation of European call option in M76 model via Lewis (2001)</span></span>
<span id="cb17-181"><a href="a-flexible-derivative-pricing-model.html#cb17-181" aria-hidden="true" tabindex="-1"></a><span class="co">  Fourier-based approach: characteristic function "jump component".</span></span>
<span id="cb17-182"><a href="a-flexible-derivative-pricing-model.html#cb17-182" aria-hidden="true" tabindex="-1"></a><span class="co">  Parameter definitions see function M76_call_value.'''</span></span>
<span id="cb17-183"><a href="a-flexible-derivative-pricing-model.html#cb17-183" aria-hidden="true" tabindex="-1"></a>  omega <span class="op">=</span> r <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> sigma <span class="op">**</span> <span class="dv">2</span> <span class="op">-</span> lamb <span class="op">*</span> (np.exp(mu <span class="op">+</span> <span class="fl">0.5</span> <span class="op">*</span> delta <span class="op">**</span> <span class="dv">2</span>) <span class="op">-</span> <span class="dv">1</span>)</span>
<span id="cb17-184"><a href="a-flexible-derivative-pricing-model.html#cb17-184" aria-hidden="true" tabindex="-1"></a>  char_func_value <span class="op">=</span> np.exp((<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> omega <span class="op">-</span> <span class="fl">0.5</span> <span class="op">*</span> u <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> sigma <span class="op">**</span> <span class="dv">2</span><span class="op">+</span> lamb <span class="op">*</span> (np.exp(<span class="ot">1j</span> <span class="op">*</span> u <span class="op">*</span> mu <span class="op">-</span> u <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> delta <span class="op">**</span> <span class="dv">2</span> <span class="op">*</span> <span class="fl">0.5</span>)<span class="op">-</span> <span class="dv">1</span>)) <span class="op">*</span> T)</span>
<span id="cb17-185"><a href="a-flexible-derivative-pricing-model.html#cb17-185" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> char_func_value</span>
<span id="cb17-186"><a href="a-flexible-derivative-pricing-model.html#cb17-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-187"><a href="a-flexible-derivative-pricing-model.html#cb17-187" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> <span class="va">__name__</span> <span class="op">==</span> <span class="st">'__main__'</span>:</span>
<span id="cb17-188"><a href="a-flexible-derivative-pricing-model.html#cb17-188" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb17-189"><a href="a-flexible-derivative-pricing-model.html#cb17-189" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example Parameters CIR85 Model</span></span>
<span id="cb17-190"><a href="a-flexible-derivative-pricing-model.html#cb17-190" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb17-191"><a href="a-flexible-derivative-pricing-model.html#cb17-191" aria-hidden="true" tabindex="-1"></a>  kappa_r, theta_r, sigma_r, r0, T <span class="op">=</span> <span class="fl">0.3</span>, <span class="fl">0.04</span>, <span class="fl">0.1</span>, <span class="fl">0.04</span>, T</span>
<span id="cb17-192"><a href="a-flexible-derivative-pricing-model.html#cb17-192" aria-hidden="true" tabindex="-1"></a>  B0T <span class="op">=</span> B([kappa_r, theta_r, sigma_r, r0, T]) <span class="co"># discount factor</span></span>
<span id="cb17-193"><a href="a-flexible-derivative-pricing-model.html#cb17-193" aria-hidden="true" tabindex="-1"></a>  r <span class="op">=</span> <span class="op">-</span>np.log(B0T) <span class="op">/</span> T</span>
<span id="cb17-194"><a href="a-flexible-derivative-pricing-model.html#cb17-194" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb17-195"><a href="a-flexible-derivative-pricing-model.html#cb17-195" aria-hidden="true" tabindex="-1"></a>  <span class="co"># Example Values</span></span>
<span id="cb17-196"><a href="a-flexible-derivative-pricing-model.html#cb17-196" aria-hidden="true" tabindex="-1"></a>  <span class="co">#</span></span>
<span id="cb17-197"><a href="a-flexible-derivative-pricing-model.html#cb17-197" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"M76 Value </span><span class="sc">%10.4f</span><span class="st">"</span> <span class="op">%</span> M76_call_value(S0, K, T, r, v0, lamb, mu, delta))</span>
<span id="cb17-198"><a href="a-flexible-derivative-pricing-model.html#cb17-198" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"H93 Value </span><span class="sc">%10.4f</span><span class="st">"</span> <span class="op">%</span> H93_call_value(S0, K, T, r, kappa_v, theta_v, sigma_v, rho, v0))</span>
<span id="cb17-199"><a href="a-flexible-derivative-pricing-model.html#cb17-199" aria-hidden="true" tabindex="-1"></a>  <span class="bu">print</span>(<span class="st">"BCC97 Value </span><span class="sc">%10.4f</span><span class="st">"</span> <span class="op">%</span> BCC_call_value(S0, K, T, r, kappa_v, theta_v,sigma_v, rho, v0, lamb, mu, delta))</span></code></pre></div>
<pre><code>## M76 Value     7.7611
## H93 Value     6.8672
## BCC97 Value     8.2942</code></pre>

</div>
</div>
  <div class="chapter-nav">
<div class="prev"><a href="the-geometric-brownian-motion-model-of-asset-value-and-monte-carlo-simulation.html"><span class="header-section-number">4</span> The geometric Brownian motion model of asset value and Monte Carlo simulation</a></div>
<div class="empty"></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#a-flexible-derivative-pricing-model"><span class="header-section-number">5</span> A flexible derivative pricing model</a></li>
<li><a class="nav-link" href="#present-value-with-stochastic-short-term-rate"><span class="header-section-number">5.1</span> Present-value with stochastic short-term rate</a></li>
<li><a class="nav-link" href="#evaluating-a-european-option-via-fourier-transform"><span class="header-section-number">5.2</span> Evaluating a European option via Fourier transform</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
          
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>FinancialMathematics</strong>" was written by Nick Syring. It was last built on 2023-02-22.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
