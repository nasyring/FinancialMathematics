<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Stochastic models of asset value and Monte Carlo simulation | FinancialMathematics</title>
  <meta name="description" content="Some notes on financial mathematics in R and Python" />
  <meta name="generator" content="bookdown 0.29 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Stochastic models of asset value and Monte Carlo simulation | FinancialMathematics" />
  <meta property="og:type" content="book" />
  
  <meta property="og:description" content="Some notes on financial mathematics in R and Python" />
  <meta name="github-repo" content="nasyring/FinancialMathematics" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Stochastic models of asset value and Monte Carlo simulation | FinancialMathematics" />
  
  <meta name="twitter:description" content="Some notes on financial mathematics in R and Python" />
  

<meta name="author" content="Nick Syring" />


<meta name="date" content="2023-01-26" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="intro.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">Financial Mathematcis in R and Python</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>2</b> Introduction</a></li>
<li class="chapter" data-level="3" data-path="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><i class="fa fa-check"></i><b>3</b> Stochastic models of asset value and Monte Carlo simulation</a>
<ul>
<li class="chapter" data-level="3.1" data-path="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#asset-values-as-random-variables"><i class="fa fa-check"></i><b>3.1</b> Asset Values as random variables</a></li>
<li class="chapter" data-level="3.2" data-path="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#geometric-brownian-motion-model-of-asset-prices-over-time"><i class="fa fa-check"></i><b>3.2</b> Geometric Brownian motion model of asset prices over time</a></li>
<li class="chapter" data-level="3.3" data-path="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#monte-carlo-simulation-of-the-gbm-model"><i class="fa fa-check"></i><b>3.3</b> Monte Carlo simulation of the gBm model</a></li>
<li class="chapter" data-level="3.4" data-path="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#off-on-a-tangent-reducing-mc-variability"><i class="fa fa-check"></i><b>3.4</b> Off on a tangent: reducing MC variability</a></li>
<li class="chapter" data-level="3.5" data-path="stochastic-models-of-asset-value-and-monte-carlo-simulation.html"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#section"><i class="fa fa-check"></i><b>3.5</b> </a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">FinancialMathematics</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="stochastic-models-of-asset-value-and-monte-carlo-simulation" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Stochastic models of asset value and Monte Carlo simulation<a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#stochastic-models-of-asset-value-and-monte-carlo-simulation" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="asset-values-as-random-variables" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Asset Values as random variables<a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#asset-values-as-random-variables" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Let <span class="math inline">\(\{S_t, t\geq 0\}\)</span> denote the values of an asset at times <span class="math inline">\(t\)</span>. Ideally, we think of time as a continuum, so that <span class="math inline">\(S_t\)</span> is a <em>continuous process</em>. Practically, however, we will approximate the continuous process by a discrete one by performing computations associated with the process at a grid of <span class="math inline">\(t\)</span> values in some interval <span class="math inline">\([0,T]\)</span> with mesh-size <span class="math inline">\(\Delta t\)</span>.</p>
<p>We model the process <span class="math inline">\(S_t\)</span> as a random or stochastic sequence; essentially, it is just a sequence of realizations of random variables.</p>
<p>Here is a plot of Apple’s (AAPL) close-of-day stock price and logarithm of return <span class="math inline">\(\log(S_t/S_{t-1})\)</span> from its initial listing to the present day. Stock prices are available much more often than daily, so the data visualized below already represent a discretization of the underlying process (with mesh-size 1 day).</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb1-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb1-2"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.random <span class="im">as</span> npr</span>
<span id="cb1-3"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb1-4"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pylab <span class="im">import</span> plt </span>
<span id="cb1-5"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb1-6"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-7"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-7" aria-hidden="true" tabindex="-1"></a>plt.style.use(<span class="st">&#39;seaborn&#39;</span>)</span>
<span id="cb1-8"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-8" aria-hidden="true" tabindex="-1"></a>mpl.rcParams[<span class="st">&#39;font.family&#39;</span>] <span class="op">=</span> <span class="st">&#39;serif&#39;</span></span>
<span id="cb1-9"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-10" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb1-11"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-11" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> yfinance <span class="im">as</span> yf</span>
<span id="cb1-12"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-12" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> yahoofinancials <span class="im">import</span> YahooFinancials</span>
<span id="cb1-13"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb1-14" aria-hidden="true" tabindex="-1"></a>aapl_df <span class="op">=</span> yf.download(<span class="st">&#39;AAPL&#39;</span>)</span></code></pre></div>
<pre><code>## 
[*********************100%***********************]  1 of 1 completed</code></pre>
<div class="sourceCode" id="cb3"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb3-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb3-1" aria-hidden="true" tabindex="-1"></a>close_price <span class="op">=</span> aapl_df[<span class="st">&#39;Adj Close&#39;</span>]</span>
<span id="cb3-2"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb3-2" aria-hidden="true" tabindex="-1"></a>log_rets <span class="op">=</span> np.log(close_price <span class="op">/</span> close_price.shift(<span class="dv">1</span>))</span>
<span id="cb3-3"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb3-3" aria-hidden="true" tabindex="-1"></a>aapl_df[<span class="st">&#39;log_rets&#39;</span>] <span class="op">=</span> log_rets</span>
<span id="cb3-4"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb3-4" aria-hidden="true" tabindex="-1"></a>aapl_df[[<span class="st">&#39;Adj Close&#39;</span>, <span class="st">&#39;log_rets&#39;</span>]].plot(subplots<span class="op">=</span><span class="va">True</span>, figsize<span class="op">=</span>(<span class="dv">10</span>, <span class="dv">6</span>))</span></code></pre></div>
<pre><code>## array([&lt;AxesSubplot:xlabel=&#39;Date&#39;&gt;, &lt;AxesSubplot:xlabel=&#39;Date&#39;&gt;],
##       dtype=object)</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb5-1" aria-hidden="true" tabindex="-1"></a>plt.show()<span class="op">;</span></span></code></pre></div>
<p><img src="Financial-Mathematics_files/figure-html/unnamed-chunk-1-1.png" width="960" /></p>
</div>
<div id="geometric-brownian-motion-model-of-asset-prices-over-time" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Geometric Brownian motion model of asset prices over time<a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#geometric-brownian-motion-model-of-asset-prices-over-time" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The mathematics of continuous stochastic processes is advanced. Rather than presenting a full account here we focus on an intermediate level of understanding of one of the most common models used for asset prices. Later we will modify the model to account for several real-life phenomena.</p>
<p>It is folk-wisdom that the log returns of at asset <span class="math inline">\(\log\frac{S_t}{S_{t-1}}\)</span> are normally-distributed, or, rather, are modeled as such. This comes as a consequence of modeling the sequence of asset prices as a <em>geometric Brownian motion</em>.</p>
<p>A Brownian motion (which is also called a Wiener process) is essentially a sequence of normal random variables. Specifically, the process <span class="math inline">\(W_t\)</span> satisfies
- <span class="math inline">\(W_0 = 0\)</span>
- <span class="math inline">\(W_t\)</span> is continuous a.s.
- <span class="math inline">\(W_t\)</span> has independent increments
- <span class="math inline">\(W_t - W_s \sim N(0,t-s)\)</span> for <span class="math inline">\(0\leq s\leq t\)</span>
Additionally, the sequence is measurable with respect to a filtration, an ordered family of sigma-fields (for details see, for example, Resnick’s A Probability Path Chapter 10).</p>
<p>The geometric Brownian motion (gBm) model says changes in asset price from time <span class="math inline">\(t\)</span> to time <span class="math inline">\(t+s\)</span> are determined by a Brownian motion and a drift. This is typically written in the following fashion as a stochastic differential equation (SDE) with respect to instantaneous price change:
<span class="math display">\[dS_t = rS_tdt + \sigma S_t dW_t\]</span>
where <span class="math inline">\(r\)</span> is a risk-free interest rate, <span class="math inline">\(dt\)</span> is an instantaneous change in time, <span class="math inline">\(\sigma\)</span> is a volatility (standard deviation) parameter, and <span class="math inline">\(W_t\)</span> is a Brownian motion.</p>
<p>It is important to keep in mind the SDE doesn’t really mean anything—rather, it is simply notation used to express a stochastic integral in a concise manner. A more meaningful expression of the geometric Brownian motion model is given by the difference equation
<span class="math display">\[S_{t+s} = S_t = \int_t^{t+s} rS_u\,du + \int_{t}^{t+s} \sigma S_u \, dW_u.\]</span>
The primary challenge to overcome is how to define integration with respect to the Brownian motion <span class="math inline">\(W_u\)</span>. For various technical reasons, such an integration cannot behave exactly in the same way integration works for real-valued functions, i.e., Riemann integration. A new theory of integration, Ito integration, is needed.</p>
<p>Rather than giving a thorough treatment of Ito’s calculus, we will simply provide an informal derivation of Ito’s Lemma, which is enough to provide a ``solution” to the geometric Brownian motion. Let <span class="math inline">\(f(t,\,S_t)\)</span> be a function of time and asset price at time <span class="math inline">\(t\)</span>. Take a two term Taylor expansion of <span class="math inline">\(f\)</span> and use the geometric Brownian motion SDE in the chain rule as follows:</p>
<p><span class="math display">\[\begin{align*}
df &amp;= \frac{\partial f}{\partial t}dt + \frac{\partial f}{\partial S_t}dS_t + \frac{1}{2}\frac{\partial^2 f}{\partial S_t^2}dS_t^2 + \cdots\\
&amp; = \frac{\partial f}{\partial t}dt + \frac{\partial f}{\partial S_t}(rS_tdt + \sigma S_t dW_t) + \frac{1}{2}\frac{\partial^2 f}{\partial S_t^2}(r^2S_t^2dt^2 + 2r\sigma S_t^2 dtdW_t + \sigma^2S_t^2dW_t^2) + \cdots.
\end{align*}\]</span></p>
<p>Then, Ito’s Lemma says <span class="math inline">\(dW_t^2 = O(dt)\)</span> and the substitution <span class="math inline">\(dW_t^2 = dt\)</span> is justified, while the terms <span class="math inline">\(dt^2\)</span> and <span class="math inline">\(dt\,dW_t\)</span> are ignorable and may be substituted by zero. The Taylor expansion simplifies, according to Ito, to
<span class="math display">\[df = \left(\frac{\partial f}{\partial t} + r S_t\frac{\partial f}{\partial S_t} +\frac{\sigma^2}{2}S_t^2\frac{\partial^2 f}{\partial S_t^2}\right)dt + \sigma\frac{\partial f}{\partial S_t}S_t \,dW_t.\]</span></p>
<p>Now, let <span class="math inline">\(f(t,\, S_t):= \log(S_t)\)</span>, the log asset price at time <span class="math inline">\(t\)</span>. In that case, we have the following derivatives:
<span class="math display">\[\partial f/\partial t = 0\quad \partial f/\partial S_t = 1/S_t \quad \partial^2 f/\partial S_t^2 = -1/S_t^2.\]</span>
Substituting these into the SDE above, we get
<span class="math display">\[d\log S_t = r\,dt - \frac{\sigma^2}{2S_t^2}S_t^2\,dt + \frac{\sigma}{S_t}S_t\,dW_t. \]</span>
Next integrate both sides:
<span class="math display">\[\log S_t = \log(S_0) + \left(r - \frac{\sigma^2}{2}\right)t + \sigma\, W_t.\]</span>
Exponentiate to obtain<br />
<span class="math display">\[S_t = S_0\exp\left(rt - \frac{\sigma^2}{2}t+\sigma \, W_t\right).\]</span>
Recall that <span class="math inline">\(W_t - W_0 := W_t\)</span> has variance <span class="math inline">\(t\)</span> and see that <span class="math inline">\(S_t/S_0\)</span> is log-normally distributed with parameters <span class="math inline">\((r - \sigma^2/2)t\)</span> and <span class="math inline">\(\sigma\, t^{1/2}\)</span>, which means it is right-skewed with mean <span class="math inline">\(\exp(rt)\)</span> and variance <span class="math inline">\((\exp(\sigma^2 t)-1)\cdot\exp(2rt)\)</span>.</p>
<p>Armed with Ito’s Lemma, we have confirmed the folk-wisdom that log-returns from time <span class="math inline">\(t\)</span> to <span class="math inline">\(t+s\)</span> are (modeled as) normal random variables with mean <span class="math inline">\((r - \frac{\sigma^2}{2}) s\)</span> and variance <span class="math inline">\(\sigma^2 s\)</span>. One last minor point: if <span class="math inline">\(S_t/S_0\)</span> has a lognormal distribution with density <span class="math inline">\(f\)</span>, then the density of <span class="math inline">\(S_t\)</span> is simply
<span class="math display">\[g(s) = S_0^{-1}f(s/S_0),\]</span>
a scaled log-normal. This is helpful, e.g., for comparing the exact distribution of <span class="math inline">\(S_t\)</span> to MC samples values of <span class="math inline">\(S_t\)</span>, as we do below.</p>
</div>
<div id="monte-carlo-simulation-of-the-gbm-model" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Monte Carlo simulation of the gBm model<a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#monte-carlo-simulation-of-the-gbm-model" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we showed above, there is an exact solution to the geometric Brownian motion SDE—namely, a continuous time random process characterized by independent, normal log-returns over disjoint time periods. Equivalently, given the asset value <span class="math inline">\(S_0\)</span> at time zero we know <span class="math inline">\(S_t/S_0\)</span> is log-normally distributed with the parameters given above.</p>
<p>Later, we will modify (complicate) the gBm model to take into account several real-life phenomena including, e.g., time-varying volatility. The augmented models do not necessarily have explicit solutions like the gBm model. Alternatively, we can simulate many times from the model to compute approximate solutions—this is called Monte Carlo. It’s not needed for the gBm model, but we will illustrate it here in order to take advantage of the simplified setting of gBm before moving on to more complicated models.</p>
<p>Below we compare three methods for computing <span class="math inline">\(S_T\)</span> at time <span class="math inline">\(T\)</span>, given <span class="math inline">\(S_0\)</span>, <span class="math inline">\(\sigma\)</span>, and <span class="math inline">\(r\)</span>: the explicit solution due to Ito, a Monte Carlo (MC) simulation from the lognormal distribution, and a MC simulation of <em>paths</em> of asset values <span class="math inline">\(S_s\)</span> for a discretization <span class="math inline">\(s\in \{s_0 = 0, s_1, \ldots, s_{M+1} = T\}\)</span>. All three provide the same answer (in a distributional sense) but the MC procedures contain some additional MC variability (noise) that decreases as the number of simulations increases.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.random <span class="im">as</span> npr</span>
<span id="cb6-3"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib <span class="im">as</span> mpl</span>
<span id="cb6-4"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib.pylab <span class="im">import</span> plt </span>
<span id="cb6-5"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb6-6"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> scipy.stats <span class="im">import</span> lognorm</span>
<span id="cb6-7"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-8" aria-hidden="true" tabindex="-1"></a>S0 <span class="op">=</span> <span class="dv">100</span></span>
<span id="cb6-9"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-9" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb6-10"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-10" aria-hidden="true" tabindex="-1"></a>sigma <span class="op">=</span> <span class="fl">0.25</span></span>
<span id="cb6-11"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-11" aria-hidden="true" tabindex="-1"></a>T <span class="op">=</span> <span class="fl">2.0</span></span>
<span id="cb6-12"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-13"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Exact density of ST based on gBm model</span></span>
<span id="cb6-14"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-14" aria-hidden="true" tabindex="-1"></a>mu <span class="op">=</span> np.exp((r <span class="op">-</span> sigma<span class="op">**</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">*</span>T)</span>
<span id="cb6-15"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-15" aria-hidden="true" tabindex="-1"></a>s <span class="op">=</span> sigma <span class="op">*</span> math.sqrt(T)</span>
<span id="cb6-16"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-16" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(lognorm.ppf(<span class="fl">0.001</span>, s, scale <span class="op">=</span> mu), lognorm.ppf(<span class="fl">0.999</span>, s, scale <span class="op">=</span> mu), <span class="dv">1000</span>)</span>
<span id="cb6-17"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-18"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-19" aria-hidden="true" tabindex="-1"></a><span class="co"># MC sampling of density of ST</span></span>
<span id="cb6-20"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-20" aria-hidden="true" tabindex="-1"></a>I<span class="op">=</span><span class="dv">10000</span></span>
<span id="cb6-21"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-21" aria-hidden="true" tabindex="-1"></a>ST <span class="op">=</span> S0 <span class="op">*</span> np.exp((r<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>sigma<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>T <span class="op">+</span> sigma<span class="op">*</span>math.sqrt(T)<span class="op">*</span>npr.standard_normal(I))</span>
<span id="cb6-22"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-23"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-24"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-24" aria-hidden="true" tabindex="-1"></a><span class="co"># MC sampling of asset price path S0 to ST at 50 equally-spaced timepoints</span></span>
<span id="cb6-25"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-25" aria-hidden="true" tabindex="-1"></a>M<span class="op">=</span><span class="dv">50</span></span>
<span id="cb6-26"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-26" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> T <span class="op">/</span> M</span>
<span id="cb6-27"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-27" aria-hidden="true" tabindex="-1"></a>S <span class="op">=</span> np.zeros((M<span class="op">+</span><span class="dv">1</span>, I))</span>
<span id="cb6-28"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-28" aria-hidden="true" tabindex="-1"></a>S[<span class="dv">0</span>] <span class="op">=</span> S0</span>
<span id="cb6-29"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-29" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> t <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,M<span class="op">+</span><span class="dv">1</span>):</span>
<span id="cb6-30"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-30" aria-hidden="true" tabindex="-1"></a>    S[t]<span class="op">=</span>S[t<span class="op">-</span><span class="dv">1</span>]<span class="op">*</span>np.exp((r <span class="op">-</span> <span class="fl">0.5</span><span class="op">*</span>sigma<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span>dt <span class="op">+</span> sigma<span class="op">*</span>math.sqrt(dt)<span class="op">*</span>npr.standard_normal(I))</span>
<span id="cb6-31"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-32"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-33"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-33" aria-hidden="true" tabindex="-1"></a><span class="co"># Plots of asset Price distribution at T = 2</span></span>
<span id="cb6-34"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-34" aria-hidden="true" tabindex="-1"></a>plt.figure(figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">6</span>))</span>
<span id="cb6-35"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-35" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">211</span>)</span>
<span id="cb6-36"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-36" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of MC samples from scaled log-normal</span></span>
<span id="cb6-37"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-37" aria-hidden="true" tabindex="-1"></a>hist1 <span class="op">=</span> plt.hist(ST,<span class="dv">100</span>,density <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb6-38"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-38" aria-hidden="true" tabindex="-1"></a><span class="co"># scaled log-normal density</span></span>
<span id="cb6-39"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-39" aria-hidden="true" tabindex="-1"></a>dens <span class="op">=</span> plt.plot(x<span class="op">*</span>S0, (<span class="dv">1</span><span class="op">/</span>S0)<span class="op">*</span>lognorm.pdf(x, s, scale <span class="op">=</span> mu),</span>
<span id="cb6-40"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-40" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;r-&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb6-41"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-41" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Asset Price&#39;</span>)</span>
<span id="cb6-42"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-42" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&#39;Exact and MC-simulated Asset Price at Time T=2&#39;</span>)</span>
<span id="cb6-43"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb6-43" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="dv">0</span>,<span class="dv">300</span>])</span></code></pre></div>
<pre><code>## (0.0, 300.0)</code></pre>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-1" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="fl">0.0014</span>])<span class="op">;</span></span>
<span id="cb8-2"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-3"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-3" aria-hidden="true" tabindex="-1"></a>plt.subplot(<span class="dv">212</span>)</span>
<span id="cb8-4"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-4" aria-hidden="true" tabindex="-1"></a><span class="co"># histogram of path-wise MC samples from scaled log-normal over grid of 50 times</span></span>
<span id="cb8-5"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-5" aria-hidden="true" tabindex="-1"></a>hist2 <span class="op">=</span> plt.hist(S[<span class="op">-</span><span class="dv">1</span>],<span class="dv">100</span>,density <span class="op">=</span> <span class="va">True</span>)</span>
<span id="cb8-6"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-6" aria-hidden="true" tabindex="-1"></a>dens <span class="op">=</span> plt.plot(x<span class="op">*</span>S0, (<span class="dv">1</span><span class="op">/</span>S0)<span class="op">*</span>lognorm.pdf(x, s, scale <span class="op">=</span> mu),</span>
<span id="cb8-7"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-7" aria-hidden="true" tabindex="-1"></a>       <span class="st">&#39;r-&#39;</span>, lw<span class="op">=</span><span class="dv">2</span>, alpha<span class="op">=</span><span class="fl">0.6</span>)</span>
<span id="cb8-8"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-8" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;Asset Price&#39;</span>)</span>
<span id="cb8-9"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-9" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;Time&#39;</span>)</span>
<span id="cb8-10"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb8-10" aria-hidden="true" tabindex="-1"></a>plt.xlim([<span class="dv">0</span>,<span class="dv">300</span>])</span></code></pre></div>
<pre><code>## (0.0, 300.0)</code></pre>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb10-1" aria-hidden="true" tabindex="-1"></a>plt.ylim([<span class="dv">0</span>,<span class="fl">0.0014</span>])<span class="op">;</span></span></code></pre></div>
</div>
<div id="off-on-a-tangent-reducing-mc-variability" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Off on a tangent: reducing MC variability<a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#off-on-a-tangent-reducing-mc-variability" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>The difference between the theoretic (exact) values for the mean and standard deviation of <span class="math inline">\(S_T\)</span> and the corresponding MC approximations (shown below) is due to MC error. The Law of Large Numbers (LLN) implies MC error declines to zero as the number of MC samples increases to infinity. In practice, using many more MC samples in order to reduce MC error has the trade-off of increasing computation time (and memory usage if storing those random variates in a vector). On the other hand, there are a few ways to reduce MC error by making more clever choices of MC samples.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats  <span class="im">as</span> scs</span>
<span id="cb11-2"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> print_stats(a2,a3):</span>
<span id="cb11-4"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-4" aria-hidden="true" tabindex="-1"></a>    stat2 <span class="op">=</span> scs.describe(a2)</span>
<span id="cb11-5"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-5" aria-hidden="true" tabindex="-1"></a>    stat3 <span class="op">=</span> scs.describe(a3)</span>
<span id="cb11-6"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-6" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;statistic&#39;</span>, <span class="st">&#39;data set 1&#39;</span>, <span class="st">&#39;data set 2&#39;</span>, <span class="st">&#39;data set 3&#39;</span>))</span>
<span id="cb11-7"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="dv">45</span> <span class="op">*</span> <span class="st">&#39;-&#39;</span>)</span>
<span id="cb11-8"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;size&#39;</span>, <span class="st">&#39;NA&#39;</span>, stat2[<span class="dv">0</span>], stat3[<span class="dv">0</span>]))</span>
<span id="cb11-9"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;min&#39;</span>, <span class="st">&#39;NA&#39;</span>, stat2[<span class="dv">1</span>][<span class="dv">0</span>], stat3[<span class="dv">1</span>][<span class="dv">0</span>] ))</span>
<span id="cb11-10"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;max&#39;</span>, <span class="st">&#39;NA&#39;</span>, stat2[<span class="dv">1</span>][<span class="dv">1</span>], stat3[<span class="dv">1</span>][<span class="dv">1</span>]))</span>
<span id="cb11-11"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;mean&#39;</span>, S0<span class="op">*</span>math.exp(r<span class="op">*</span>T), stat2[<span class="dv">2</span>], stat3[<span class="dv">2</span>]))</span>
<span id="cb11-12"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-12" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;stdev&#39;</span>, S0<span class="op">*</span>math.sqrt((math.exp(sigma<span class="op">**</span><span class="dv">2</span> <span class="op">*</span> T)<span class="op">-</span><span class="dv">1</span>)<span class="op">*</span>math.exp(<span class="dv">2</span><span class="op">*</span>r<span class="op">*</span>T)), np.sqrt(stat2[<span class="dv">3</span>]), np.sqrt(stat3[<span class="dv">3</span>])))</span>
<span id="cb11-13"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-14"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb11-15" aria-hidden="true" tabindex="-1"></a>print_stats(ST, S[<span class="op">-</span><span class="dv">1</span>])</span></code></pre></div>
<pre><code>##      statistic     data set 1     data set 2     data set 3
## ---------------------------------------------
##           size             NA      10000.000      10000.000
##            min             NA         25.273         22.064
##            max             NA        322.920        344.869
##           mean        110.517        110.639        109.805
##          stdev         40.327         39.438         39.651</code></pre>
<p>The simplest way to reduce MC variability (besides increasing the number of samples) is to use <em>anti-thetical variates</em>. When sampling standard normal random variates this amounts to sampling <span class="math inline">\(z\)</span> and using both <span class="math inline">\((z,-z)\)</span> as samples. To get <span class="math inline">\(2I\)</span> samples one only needs to actually compute <span class="math inline">\(I\)</span> samples, the remaining <span class="math inline">\(I\)</span> are the same in magnitude but with the opposite signs. This accomplishes exact mean-matching, i.e., <span class="math inline">\((2I)^{-1}\sum_{i=1}^{2I} z_i = 0\)</span>, exactly the standard normal distribution mean. <br></p>
<p>Another method for reducing MC variability is second-moment matching. Suppose we generate antithetical samples <span class="math inline">\(z = (z_1, \ldots, z_I)\)</span>. Let <span class="math inline">\(z^\star_i := z_i / s_{z}\)</span> for <span class="math inline">\(i=1, \ldots, I\)</span> where <span class="math inline">\(s_z\)</span> is the sample standard deviation of <span class="math inline">\(z\)</span>. Now, <span class="math inline">\(z^\star\)</span> has sample mean exactly zero and sample standard deviation exactly <span class="math inline">\(1\)</span>. <br></p>
<p>Further, a Box-Cox transformation may be used if the samples <span class="math inline">\(z\)</span> have positive skew. (If they have negative skew, then the samples may be reflected about the maximum value to produce a set of positively-skewed values starting from zero.) After applying the Box-cox transformation, the resulting values <span class="math inline">\(y\)</span> should be close to symmetric (closer to a normal distribution than the original variates) and a further standardization <span class="math inline">\(z^\star_i = (y_i - \overline y)/s_y\)</span> may be used to transform the values to approximately standard normal.</p>
<p>The following simulation supports the use of standardized antithetic variates. By design, these had exactly zero mean and unit variance, but were slightly more likely to be skewed compared to vanilly MC samples. Box-Cox transformed variates did not perform better, and were more likely to display excess kurtosis than even vanilla MC variates. It is worth pointing out that antithetic variates may be produced sequentially while standardized variates requires storing all variates in memory, which may be a problem in some applications.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> scipy.stats  <span class="im">as</span> scs</span>
<span id="cb13-2"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy  <span class="im">as</span> np</span>
<span id="cb13-3"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy.random  <span class="im">as</span> npr</span>
<span id="cb13-4"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> bc_standardize(z):</span>
<span id="cb13-6"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-6" aria-hidden="true" tabindex="-1"></a>  M <span class="op">=</span> np.<span class="bu">max</span>(z)</span>
<span id="cb13-7"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-7" aria-hidden="true" tabindex="-1"></a>  zM <span class="op">=</span> M<span class="op">-</span>z<span class="op">+</span><span class="fl">0.0000001</span></span>
<span id="cb13-8"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-8" aria-hidden="true" tabindex="-1"></a>  y <span class="op">=</span> scs.boxcox(zM)</span>
<span id="cb13-9"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-9" aria-hidden="true" tabindex="-1"></a>  m <span class="op">=</span> np.mean(y[<span class="dv">0</span>])</span>
<span id="cb13-10"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-10" aria-hidden="true" tabindex="-1"></a>  s <span class="op">=</span> np.std(y[<span class="dv">0</span>], ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-11"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-11" aria-hidden="true" tabindex="-1"></a>  z_star <span class="op">=</span> (y[<span class="dv">0</span>]<span class="op">-</span>m)<span class="op">/</span>s</span>
<span id="cb13-12"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> z_star</span>
<span id="cb13-13"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-14"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-14" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> at_standardize(z):</span>
<span id="cb13-15"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-15" aria-hidden="true" tabindex="-1"></a>  s <span class="op">=</span> np.std(z, ddof<span class="op">=</span><span class="dv">1</span>)</span>
<span id="cb13-16"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-16" aria-hidden="true" tabindex="-1"></a>  z_star <span class="op">=</span> z<span class="op">/</span>s</span>
<span id="cb13-17"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-17" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> z_star</span>
<span id="cb13-18"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-19" aria-hidden="true" tabindex="-1"></a>kurtosis_vals <span class="op">=</span> np.zeros((<span class="dv">1000</span>,<span class="dv">8</span>))</span>
<span id="cb13-20"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-20" aria-hidden="true" tabindex="-1"></a>skew_vals <span class="op">=</span> np.zeros_like(kurtosis_vals)</span>
<span id="cb13-21"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-21" aria-hidden="true" tabindex="-1"></a>mean_vals <span class="op">=</span> np.zeros_like(kurtosis_vals)</span>
<span id="cb13-22"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-22" aria-hidden="true" tabindex="-1"></a>std_vals <span class="op">=</span> np.zeros_like(kurtosis_vals)</span>
<span id="cb13-23"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-24"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-24" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">1001</span>):</span>
<span id="cb13-25"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-25" aria-hidden="true" tabindex="-1"></a>  X <span class="op">=</span> npr.standard_normal(<span class="dv">10000</span>)</span>
<span id="cb13-26"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-26" aria-hidden="true" tabindex="-1"></a>  Z1 <span class="op">=</span> npr.standard_normal(<span class="dv">5000</span>)</span>
<span id="cb13-27"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-27" aria-hidden="true" tabindex="-1"></a>  Z2 <span class="op">=</span> npr.standard_normal(<span class="dv">5000</span>)</span>
<span id="cb13-28"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-28" aria-hidden="true" tabindex="-1"></a>  Z3 <span class="op">=</span> <span class="op">-</span>Z1</span>
<span id="cb13-29"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-29" aria-hidden="true" tabindex="-1"></a>  Z4 <span class="op">=</span> <span class="op">-</span>Z2</span>
<span id="cb13-30"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-30" aria-hidden="true" tabindex="-1"></a>  Z <span class="op">=</span> np.concatenate((Z1,Z2))</span>
<span id="cb13-31"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-31" aria-hidden="true" tabindex="-1"></a>  Y <span class="op">=</span> np.concatenate((Z1,Z3))</span>
<span id="cb13-32"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-32" aria-hidden="true" tabindex="-1"></a>  W <span class="op">=</span> np.concatenate((Z2,Z4))</span>
<span id="cb13-33"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-33" aria-hidden="true" tabindex="-1"></a>  Ystar <span class="op">=</span> bc_standardize(Y)</span>
<span id="cb13-34"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-34" aria-hidden="true" tabindex="-1"></a>  Wstar <span class="op">=</span> bc_standardize(W)</span>
<span id="cb13-35"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-35" aria-hidden="true" tabindex="-1"></a>  Yst <span class="op">=</span> at_standardize(Y)</span>
<span id="cb13-36"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-36" aria-hidden="true" tabindex="-1"></a>  Wst <span class="op">=</span> at_standardize(W)</span>
<span id="cb13-37"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-37" aria-hidden="true" tabindex="-1"></a>  stat1 <span class="op">=</span> scs.describe(X, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-38"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-38" aria-hidden="true" tabindex="-1"></a>  stat2 <span class="op">=</span> scs.describe(Z, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-39"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-39" aria-hidden="true" tabindex="-1"></a>  stat3 <span class="op">=</span> scs.describe(Y, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-40"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-40" aria-hidden="true" tabindex="-1"></a>  stat4 <span class="op">=</span> scs.describe(W, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-41"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-41" aria-hidden="true" tabindex="-1"></a>  stat5 <span class="op">=</span> scs.describe(Ystar, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-42"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-42" aria-hidden="true" tabindex="-1"></a>  stat6 <span class="op">=</span> scs.describe(Wstar, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-43"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-43" aria-hidden="true" tabindex="-1"></a>  stat7 <span class="op">=</span> scs.describe(Yst, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-44"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-44" aria-hidden="true" tabindex="-1"></a>  stat8 <span class="op">=</span> scs.describe(Wst, ddof <span class="op">=</span> <span class="dv">1</span>)</span>
<span id="cb13-45"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-45" aria-hidden="true" tabindex="-1"></a>  mean_vals[i<span class="op">-</span><span class="dv">1</span>,:] <span class="op">=</span> np.array([stat1[<span class="dv">2</span>], stat2[<span class="dv">2</span>], stat3[<span class="dv">2</span>], stat4[<span class="dv">2</span>], stat5[<span class="dv">2</span>], stat6[<span class="dv">2</span>], stat7[<span class="dv">2</span>], stat8[<span class="dv">2</span>]])</span>
<span id="cb13-46"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-46" aria-hidden="true" tabindex="-1"></a>  std_vals[i<span class="op">-</span><span class="dv">1</span>,:] <span class="op">=</span> np.array([stat1[<span class="dv">3</span>], stat2[<span class="dv">3</span>], stat3[<span class="dv">3</span>], stat4[<span class="dv">3</span>], stat5[<span class="dv">3</span>], stat6[<span class="dv">3</span>], stat7[<span class="dv">3</span>], stat8[<span class="dv">3</span>]])</span>
<span id="cb13-47"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-47" aria-hidden="true" tabindex="-1"></a>  kurtosis_vals[i<span class="op">-</span><span class="dv">1</span>,:] <span class="op">=</span> np.array([stat1[<span class="dv">4</span>], stat2[<span class="dv">4</span>], stat3[<span class="dv">4</span>], stat4[<span class="dv">4</span>], stat5[<span class="dv">4</span>], stat6[<span class="dv">4</span>], stat7[<span class="dv">4</span>], stat8[<span class="dv">4</span>]])</span>
<span id="cb13-48"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-48" aria-hidden="true" tabindex="-1"></a>  skew_vals[i<span class="op">-</span><span class="dv">1</span>,:] <span class="op">=</span> np.array([stat1[<span class="dv">5</span>], stat2[<span class="dv">5</span>], stat3[<span class="dv">5</span>], stat4[<span class="dv">5</span>], stat5[<span class="dv">5</span>], stat6[<span class="dv">5</span>], stat7[<span class="dv">5</span>], stat8[<span class="dv">5</span>]])</span>
<span id="cb13-49"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-50"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb13-50" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14s</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;statistic&#39;</span>, <span class="st">&#39;data set 1&#39;</span>, <span class="st">&#39;data set 2&#39;</span>, <span class="st">&#39;data set 3&#39;</span>, <span class="st">&#39;data set 4&#39;</span>, <span class="st">&#39;data set 5&#39;</span>, <span class="st">&#39;data set 6&#39;</span>, <span class="st">&#39;data set 7&#39;</span>, <span class="st">&#39;data set 8&#39;</span>))</span></code></pre></div>
<pre><code>##      statistic     data set 1     data set 2     data set 3     data set 4     data set 5     data set 6     data set 7     data set 8</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;mean mean&#39;</span>, np.mean(mean_vals[:,<span class="dv">0</span>]), np.mean(mean_vals[:,<span class="dv">1</span>]), np.mean(mean_vals[:,<span class="dv">2</span>]), np.mean(mean_vals[:,<span class="dv">3</span>]), np.mean(mean_vals[:,<span class="dv">4</span>]), np.mean(mean_vals[:,<span class="dv">5</span>]), np.mean(mean_vals[:,<span class="dv">6</span>]), np.mean(mean_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##      mean mean         -0.001          0.000         -0.000         -0.000         -0.000          0.000         -0.000          0.000</code></pre>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;std mean&#39;</span>, np.std(mean_vals[:,<span class="dv">0</span>]), np.std(mean_vals[:,<span class="dv">1</span>]), np.std(mean_vals[:,<span class="dv">2</span>]), np.std(mean_vals[:,<span class="dv">3</span>]), np.std(mean_vals[:,<span class="dv">4</span>]), np.std(mean_vals[:,<span class="dv">5</span>]), np.std(mean_vals[:,<span class="dv">6</span>]), np.std(mean_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##       std mean          0.010          0.010          0.000          0.000          0.000          0.000          0.000          0.000</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;mean std&#39;</span>, np.mean(std_vals[:,<span class="dv">0</span>]), np.mean(std_vals[:,<span class="dv">1</span>]), np.mean(std_vals[:,<span class="dv">2</span>]), np.mean(std_vals[:,<span class="dv">3</span>]), np.mean(std_vals[:,<span class="dv">4</span>]), np.mean(std_vals[:,<span class="dv">5</span>]), np.mean(std_vals[:,<span class="dv">6</span>]), np.mean(std_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##       mean std          1.000          0.999          1.000          0.999          1.000          1.000          1.000          1.000</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;std std&#39;</span>, np.std(std_vals[:,<span class="dv">0</span>]), np.std(std_vals[:,<span class="dv">1</span>]), np.std(std_vals[:,<span class="dv">2</span>]), np.std(std_vals[:,<span class="dv">3</span>]), np.std(std_vals[:,<span class="dv">4</span>]), np.std(std_vals[:,<span class="dv">5</span>]), np.std(std_vals[:,<span class="dv">6</span>]), np.std(std_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##        std std          0.014          0.014          0.020          0.020          0.000          0.000          0.000          0.000</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;mean kurtosis&#39;</span>, np.mean(kurtosis_vals[:,<span class="dv">0</span>]), np.mean(kurtosis_vals[:,<span class="dv">1</span>]), np.mean(kurtosis_vals[:,<span class="dv">2</span>]), np.mean(kurtosis_vals[:,<span class="dv">3</span>]), np.mean(kurtosis_vals[:,<span class="dv">4</span>]), np.mean(kurtosis_vals[:,<span class="dv">5</span>]), np.mean(kurtosis_vals[:,<span class="dv">6</span>]), np.mean(kurtosis_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##  mean kurtosis          0.000          0.000          0.000         -0.000         -0.010         -0.010         -0.000          0.000</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;std kurtosis&#39;</span>, np.std(kurtosis_vals[:,<span class="dv">0</span>]), np.std(kurtosis_vals[:,<span class="dv">1</span>]), np.std(kurtosis_vals[:,<span class="dv">2</span>]), np.std(kurtosis_vals[:,<span class="dv">3</span>]), np.std(kurtosis_vals[:,<span class="dv">4</span>]), np.std(kurtosis_vals[:,<span class="dv">5</span>]), np.std(kurtosis_vals[:,<span class="dv">6</span>]), np.std(kurtosis_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##   std kurtosis          0.024          0.025          0.000          0.000          0.007          0.007          0.000          0.000</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;mean skew&#39;</span>, np.mean(skew_vals[:,<span class="dv">0</span>]), np.mean(skew_vals[:,<span class="dv">1</span>]), np.mean(skew_vals[:,<span class="dv">2</span>]), np.mean(skew_vals[:,<span class="dv">3</span>]), np.mean(skew_vals[:,<span class="dv">4</span>]), np.mean(skew_vals[:,<span class="dv">5</span>]), np.mean(skew_vals[:,<span class="dv">6</span>]), np.mean(skew_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##      mean skew         -0.003          0.002          0.002          0.001          0.006          0.005          0.002          0.001</code></pre>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="stochastic-models-of-asset-value-and-monte-carlo-simulation.html#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&#39;</span><span class="sc">%14s</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st"> </span><span class="sc">%14.3f</span><span class="st">&#39;</span> <span class="op">%</span> (<span class="st">&#39;std skew&#39;</span>, np.std(skew_vals[:,<span class="dv">0</span>]), np.std(skew_vals[:,<span class="dv">1</span>]), np.std(skew_vals[:,<span class="dv">2</span>]), np.std(skew_vals[:,<span class="dv">3</span>]), np.std(skew_vals[:,<span class="dv">4</span>]), np.std(skew_vals[:,<span class="dv">5</span>]), np.std(skew_vals[:,<span class="dv">6</span>]), np.std(skew_vals[:,<span class="dv">7</span>])))</span></code></pre></div>
<pre><code>##       std skew          0.049          0.050          0.070          0.069          0.067          0.066          0.070          0.069</code></pre>
</div>
<div id="section" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> </h2>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="intro.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/02-MonteCarlo.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["Financial Mathematics.pdf", "Financial Mathematics.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
